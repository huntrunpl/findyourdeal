// Unified i18n system with EN as base and hard fallback

const TRANSLATIONS = {
  en: {
    // Commands
    cmd: {
      help_greeting: "ğŸ‘‹ Hello! This is FindYourDeal bot.",
      help_basic: "Basic commands:",
      help_basic_lista: "/lista â€“ show your active monitored links",
      help_basic_usun: "/usun &lt;ID&gt; â€“ disable monitoring for link ID",
      help_basic_dodaj: "/dodaj &lt;url&gt; [name] â€“ add new link to monitor",
      help_basic_status: "/status â€“ bot status, plan, and notifications",
      help_basic_panel: "/panel â€“ open management panel",
      help_notif: "PUSH notifications on this chat:",
      help_notif_on: "/on â€“ enable",
      help_notif_off: "/off â€“ disable",
      help_notif_single: "/pojedyncze â€“ single cards",
      help_notif_batch: "/zbiorcze â€“ batch list",
      help_perlink: "Per-link mode (ONLY on this chat):",
      help_perlink_commands: "/pojedyncze_ID, /zbiorcze_ID, /off_ID (e.g. /zbiorcze_18)",
      help_quiet: "Quiet hours:",
      help_quiet_show: "/cisza â€“ show",
      help_quiet_set: "/cisza HH-HH â€“ set (e.g. /cisza 22-7)",
      help_quiet_off: "/cisza_off â€“ disable",
      help_history: "Sent history:",
      help_history_najnowsze: "/najnowsze â€“ newest sent on this chat",
      help_history_najnowsze_id: "/najnowsze &lt;ID&gt; â€“ newest sent for link",
      help_history_najtansze: "/najtansze â€“ cheapest sent on this chat",
      help_history_najtansze_id: "/najtansze &lt;ID&gt; â€“ cheapest sent for link",
      help_examples: "Examples:",
      help_basic_nazwa: "/nazwa <ID> [new name] â€“ rename monitored link",
      help_plans: "Plans:",
      help_plans_show: "/plany â€“ show available plans and purchase options",
      help_lang: "Language:",
      help_lang_set: "/lang <code> â€“ set language (e.g. /lang en, /lang pl)",
      help_advanced: "Advanced per-link settings:",
      help_advanced_priorytet: "/priorytet <ID> <value> â€“ set priority (1-10)",
      help_advanced_ukry: "/ukry <ID> â€“ hide sent offers from /najnowsze",
      help_advanced_ukry_off: "/ukry_off <ID> â€“ show sent offers again",
      help_advanced_config: "/config <ID> â€“ show link configuration",
      help_advanced_zapis: "/zapis <ID> â€“ save sent offers to history",
      help_advanced_zapis_off: "/zapis_off <ID> â€“ stop saving",
      help_advanced_cena: "/cena <ID> <max> â€“ filter by max price",
      help_advanced_cena_off: "/cena_off <ID> â€“ disable price filter",
      help_advanced_rozmiar: "/rozmiar <ID> <size> â€“ filter by size",
      help_advanced_rozmiar_off: "/rozmiar_off <ID> â€“ disable size filter",
      help_advanced_marka: "/marka <ID> <brand> â€“ filter by brand",
      help_advanced_marka_off: "/marka_off <ID> â€“ disable brand filter",
      help_advanced_max: "/max <ID> <count> â€“ limit daily notifications",
      help_advanced_max_off: "/max_off <ID> â€“ remove limit",
      help_advanced_filtry: "/filtry <ID> â€“ show all filters",
      help_advanced_resetfiltry: "/resetfiltry <ID> â€“ clear all filters",
      help_advanced_perlink_space: " ",
      
      help: "Available commands:\n/start - Start bot\n/help - Show help\n/dodaj - Add search\n/usun - Remove search\n/lista - List searches\n/status - Show status\n/on - Enable notifications\n/off - Disable notifications\n/pojedyncze - Single mode\n/zbiorcze - Batch mode\n/cisza - Set quiet hours\n/cisza_off - Disable quiet hours\n/najnowsze [ID] - Show newest items\n/najtansze [ID] - Show cheapest items\n/plany - Show plans\n/panel - Get panel link\n/lang - Change language",
      
      unauthorized: "âŒ Unauthorized (admin only).",
      provide_id: "âŒ Provide Telegram ID: /admin_reset &lt;telegram_id&gt;",
      user_not_found: "âŒ User not found for Telegram ID {id}",
      user_not_in_db: "Can't see you in database. Use /start or /dodaj.",
      user_not_registered: "Can't see you in database yet.\nFirst use /dodaj (registers account), then /status.",
      
      link_not_found: "Couldn't find link with ID <b>{id}</b> on your account. Use /lista.",
      no_links: "You don't have any links yet.",
      
      usage_usun: "Provide link ID, e.g.:\n<code>/usun 18</code>",
      usage_najnowsze: "Usage: <code>/najnowsze [ID]</code>\nWithout ID: all links\nWith ID: specific link\n\nExamples:\n<code>/najnowsze</code>\n<code>/najnowsze 18</code>",
      usage_najtansze: "Usage: <code>/najtansze [ID]</code>\nWithout ID: all links\nWith ID: specific link\n\nExamples:\n<code>/najtansze</code>\n<code>/najtansze 18</code>",
      usage_dodaj: "Usage:\n<code>/dodaj &lt;url&gt; [name]</code>\n\nExample:\n<code>/dodaj https://www.olx.pl/oferty/?q=iphone14 iPhone 14 OLX</code>",
      
      error_panel: "âŒ Failed to generate panel link.\n\nrequestId: {requestId}",
      error_payment_config: "âŒ Payment configuration error.\n\nrequestId: {requestId}",
      error_addon_config: "âŒ Addon configuration error.\n\nrequestId: {requestId}",
      error_no_purchase: "âŒ No purchase options available.",
      error_payment_create: "âŒ Error creating payment.\n\nrequestId: {requestId}",
      error_lista: "âŒ Error fetching link list.",
      error_usun: "âŒ Error disabling link.",
      error_dodaj: "âŒ Error adding link.",
      error_status: "âŒ Error fetching status.",
      error_stripe_not_configured: "âŒ Stripe not configured.\n\nrequestId: {requestId}",
      error_addon_not_configured: "âŒ No configuration for addon.\n\nrequestId: {requestId}",
      
      // Command responses for notification commands
      notif_enabled_response: "âœ… Notifications ENABLED on this chat.",
      notif_disabled_response: "â›” Notifications DISABLED on this chat.",
      notif_single_response: "ğŸ“¨ Mode set: <b>single</b> (default for this chat).",
      notif_batch_response: "ğŸ“¦ Mode set: <b>batch</b> (default for this chat).",
    },
    
    // /dodaj specific messages
    dodaj: {
      invalid_url: "First parameter must be a valid URL, e.g.:\n<code>/dodaj https://www.olx.pl/oferty/?q=iphone14 iPhone 14 OLX</code>",
      trial_expired: "â° Your Trial plan has expired.\nMonitoring in Trial is no longer available.\n\nTo continue using the bot, choose a paid plan (Starter / Growth / Platinum).",
      plan_expired: "â° Your plan has expired.\nTo add new links and resume monitoring, renew your plan in the customer panel.",
      no_active_plan_trial_used: "You don't have an active plan with link monitoring.\nTrial has already been used. Purchase Starter / Growth / Platinum plan.",
      no_active_plan_trial_available: "You don't have an active plan with link monitoring.\nYou can start a one-time Trial (3 days / 5 links) or choose Starter / Growth / Platinum plan.",
      success: "âœ… Added new link for monitoring:\n\nID <b>{id}</b> â€” {name}\n<code>{url}</code>\n\nActive links: {active}/{limit}\n\nCheck links with: <code>/lista</code>",
      no_name: "(no name)",
    },
    
    // /najnowsze specific
    najnowsze: {
      header: "ğŸ§¾ Newest offers\n<b>{name}</b> <i>(ID {id})</i>\n",
      no_history: "\nNo saved history for this link yet.",
      no_title: "(no title)",
      truncated: "â€¦ (truncated â€“ message length limit)\n",
      link_not_found_detail: "Can't see link <b>{id}</b> on your account. Check <code>/lista</code>.",
    },
    
    // Notifications
    notif: {
      enabled: "âœ… Notifications ENABLED for this chat.",
      disabled: "â›” Notifications DISABLED for this chat.",
      mode_single: "ğŸ“¨ Mode set: <b>single</b> (default for this chat).",
      mode_batch: "ğŸ“¦ Mode set: <b>batch</b> (default for this chat).",
    },
    
    // Quiet hours
    quiet: {
      status_on: "ğŸŒ™ Quiet hours: <b>ENABLED</b>, hours {from}:00â€“{to}:00",
      status_off: "ğŸŒ™ Quiet hours: <b>disabled</b>.\nSet: <code>/cisza 22-7</code>",
      usage: "Provide range as HH-HH, e.g. <code>/cisza 22-7</code>",
      invalid_hours: "Hours must be in range 0â€“23, e.g. <code>/cisza 22-7</code>",
      set: "ğŸŒ™ Quiet hours set: <b>{from}:00â€“{to}:00</b>",
      disabled: "ğŸŒ™ Quiet hours <b>disabled</b>.",
      disabled_alt: "ğŸŒ™ Quiet hours: <b>DISABLED</b>",
    },
    
    // Lista
    lista: {
      header: "ğŸ“‹ Active monitored links:\n\n",
      footer: "Disable: <code>/usun ID</code>\ne.g. <code>/usun 18</code>",
      no_name: "(no name)",
    },
    
    // Usun
    usun: {
      success: "âœ… Stopped monitoring link:\n\n",
      footer: "You can re-enable it in the panel or add it again as a new search.",
    },
    
    // Najnowsze
    najnowsze: {
      header: "ğŸ†• Newest items for link ID <b>{id}</b>",
      no_history: "No saved history for this link yet.",
    },
    
    // Status
    status: {
      title: "â„¹ï¸ Bot Status",
      plan: "Plan: {name} (until {exp})",
      plan_with_addons: "Plan: {name} (until {exp})\nAddons (+10 links each): {addons}",
      links_enabled: "Active searches (enabled): {enabled}/{limit}",
      links_total: "Total searches (in database): {total}/{limit}",
      daily_limit: "Daily notification limit: {limit}",
      notif_enabled: "âœ… Notifications ENABLED",
      notif_disabled: "â›” Notifications DISABLED",
      notif_mode: "Default mode for this chat: {mode}",
      notif_daily: "Today's notifications: {daily}/{limit}",
      chat_line_enabled: "âœ… Notifications ENABLED\nDefault mode for this chat: {mode}\nToday's notifications: {daily}/{limit}",
      chat_line_disabled: "â›” Notifications DISABLED\nDefault mode for this chat: {mode}\nToday's notifications: {daily}/{limit}",
      quiet_on: "Quiet hours: enabled ({from}:00â€“{to}:00)",
      quiet_off: "Quiet hours: disabled",
      per_link_hint: "Commands: /on /off /single /batch\nPer link: /single_ID /batch_ID /off_ID /on_ID",
      no_links: "No active searches.",
      links_header: "Search list:",
      unknown: "(error)",
    },
    
    // Language
    lang: {
      current: "ğŸŒ Current language: <b>{name}</b>",
      available: "Available languages:",
      unknown: "âŒ Unknown language. Supported: {list}",
      confirm: "âœ… Language changed to: <b>{name}</b>",
      unknown_language: "Unknown language.",
    },
    
    // Payments & plans
    payment: {
      panel_link: "ğŸ§­ <b>Panel</b>\n\nLink to panel (valid for {minutes} minutes, one-time use):\n\n{url}\n\nâš ï¸ <i>Link is valid only for {minutes} minutes and can be used only once.</i>",
      platinum_addon: "ğŸ“‹ <b>Your plan: Platinum</b>\nâ° <b>Valid until:</b> {expiryDate}\nğŸ”— <b>Links limit:</b> {totalLinks}{addonText}\n\n<b>Add +10 links (addon):</b>\n\n{url}\n\nâš ï¸ <i>Link leads to secure Stripe payment.</i>",
      platinum_addon_packages: " (+{count} addon packages)",
      plans_list: "ğŸ’³ <b>Available subscription plans</b>\n\nYour current plan: <b>{planLabel}</b>\n\n{url}",
      plans_list_keyboard: "ğŸ’³ <b>Available subscription plans</b>\n\nYour current plan: <b>{planLabel}</b>\n\nChoose plan:",
      addon_checkout: "ğŸ’ <b>Addon: +10 links</b>\n\nGo to payment:\n{url}\n\n<i>requestId: {requestId}</i>",
      addon_button: "âœ“ Addon +10 links",
      error_config: "âŒ Configuration error",
      error_payment: "âŒ Payment creation error.\n\nrequestId: {requestId}",
      checkout_url: "ğŸ’³ <b>Plan: {planCode}</b>\n\nGo to payment:\n{url}\n\n<i>requestId: {requestId}</i>",
    },
    
    // Callbacks
    callback: {
      no_chat_data: "No chat/user data.",
      mode_set: "Set: {mode}",
      mode_set_failed: "âŒ Failed to set mode.",
      link_mode_set: "âœ… Link <b>{linkId}</b> on this chat set to: <b>{mode}</b>",
    },
    
    // Admin
    admin: {
      reset_success: "âœ… Admin reset done for TG {tgId}. Chats updated: {chats}. Active links reset: {links}. Since={since}",
      no_telegram_id: "Failed to determine your Telegram ID. Try again.",
    },
    
    // General
    general: {
      unknown_command: "â“ Unknown command. Use /help.",
    },
    
    // /najtansze (cheapest sent offers)
    najtansze: {
      header_per_link: "ğŸ’° Cheapest sent offers (link {id})\n<b>{name}</b>\nSince: {since}",
      header_global: "ğŸ’° Cheapest sent offers (since {since})",
      no_history_per_link: "No sent offers with price for link <b>{id}</b> since {since}.",
      no_history_global: "No sent offers with price since {since}.",
      footer: "Full history:",
    },
    
    // Enhanced najnowsze (newest sent offers)
    najnowsze_enhanced: {
      header_per_link: "ğŸ§¾ Newest sent offers (link {id})\n<b>{name}</b>\nSince: {since}",
      header_global: "ğŸ§¾ Newest sent offers (since {since})",
      no_history_per_link: "No sent offers for link <b>{id}</b> since {since}.",
      no_history_global: "No sent offers since {since}.",
      footer: "Full history:",
      no_title: "(no title)",
    },
  },
  
  pl: {
    // Polish translations (juÅ¼ istniejÄ…ce)
    cmd: {
      help_greeting: "ğŸ‘‹ CzeÅ›Ä‡! To bot FindYourDeal.",
      help_basic: "Podstawowe komendy:",
      help_basic_lista: "/lista â€“ pokaÅ¼ Twoje aktywne monitorowane linki",
      help_basic_usun: "/usun &lt;ID&gt; â€“ wyÅ‚Ä…cz monitorowanie linku o ID",
      help_basic_dodaj: "/dodaj &lt;url&gt; [nazwa] â€“ dodaj nowy link do monitorowania",
      help_basic_status: "/status â€“ status bota, planu i powiadomieÅ„",
      help_basic_panel: "/panel â€“ otwÃ³rz panel zarzÄ…dzania",
      help_notif: "Powiadomienia PUSH na tym czacie:",
      help_notif_on: "/on â€“ wÅ‚Ä…cz",
      help_notif_off: "/off â€“ wyÅ‚Ä…cz",
      help_notif_single: "/pojedyncze â€“ pojedyncze karty",
      help_notif_batch: "/zbiorcze â€“ zbiorcza lista",
      help_perlink: "Tryb per-link (TYLKO na tym czacie):",
      help_perlink_commands: "/pojedyncze_ID, /zbiorcze_ID, /off_ID (np. /zbiorcze_18)",
      help_quiet: "Cisza nocna:",
      help_quiet_show: "/cisza â€“ pokaÅ¼",
      help_quiet_set: "/cisza HH-HH â€“ ustaw (np. /cisza 22-7)",
      help_quiet_off: "/cisza_off â€“ wyÅ‚Ä…cz",
      help_history: "Historia wysÅ‚anych:",
      help_history_najnowsze: "/najnowsze â€“ najnowsze wysÅ‚ane na tym czacie",
      help_history_najnowsze_id: "/najnowsze &lt;ID&gt; â€“ najnowsze wysÅ‚ane dla linku",
      help_history_najtansze: "/najtansze â€“ najtaÅ„sze wysÅ‚ane na tym czacie",
      help_history_najtansze_id: "/najtansze &lt;ID&gt; â€“ najtaÅ„sze wysÅ‚ane dla linku",
      help_examples: "PrzykÅ‚ady:",
      help_basic_nazwa: "/nazwa <ID> [nowa nazwa] â€“ zmieÅ„ nazwÄ™ monitorowanego linku",
      help_plans: "Plany:",
      help_plans_show: "/plany â€“ pokaÅ¼ dostÄ™pne plany i opcje zakupu",
      help_lang: "JÄ™zyk:",
      help_lang_set: "/lang <kod> â€“ ustaw jÄ™zyk (np. /lang en, /lang pl)",
      help_advanced: "Zaawansowane ustawienia per-link:",
      help_advanced_priorytet: "/priorytet <ID> <wartoÅ›Ä‡> â€“ ustaw priorytet (1-10)",
      help_advanced_ukry: "/ukry <ID> â€“ ukryj wysÅ‚ane oferty w /najnowsze",
      help_advanced_ukry_off: "/ukry_off <ID> â€“ pokaÅ¼ wysÅ‚ane oferty ponownie",
      help_advanced_config: "/config <ID> â€“ pokaÅ¼ konfiguracjÄ™ linku",
      help_advanced_zapis: "/zapis <ID> â€“ zapisuj wysÅ‚ane oferty do historii",
      help_advanced_zapis_off: "/zapis_off <ID> â€“ przestaÅ„ zapisywaÄ‡",
      help_advanced_cena: "/cena <ID> <max> â€“ filtruj po maksymalnej cenie",
      help_advanced_cena_off: "/cena_off <ID> â€“ wyÅ‚Ä…cz filtr ceny",
      help_advanced_rozmiar: "/rozmiar <ID> <rozmiar> â€“ filtruj po rozmiarze",
      help_advanced_rozmiar_off: "/rozmiar_off <ID> â€“ wyÅ‚Ä…cz filtr rozmiaru",
      help_advanced_marka: "/marka <ID> <marka> â€“ filtruj po marce",
      help_advanced_marka_off: "/marka_off <ID> â€“ wyÅ‚Ä…cz filtr marki",
      help_advanced_max: "/max <ID> <liczba> â€“ ogranicz dzienne powiadomienia",
      help_advanced_max_off: "/max_off <ID> â€“ usuÅ„ limit",
      help_advanced_filtry: "/filtry <ID> â€“ pokaÅ¼ wszystkie filtry",
      help_advanced_resetfiltry: "/resetfiltry <ID> â€“ wyczyÅ›Ä‡ wszystkie filtry",
      help_advanced_perlink_space: " ",
      
      help: "DostÄ™pne komendy:\n/start - Start bota\n/help - Pomoc\n/dodaj - Dodaj wyszukiwanie\n/usun - UsuÅ„ wyszukiwanie\n/lista - Lista wyszukiwaÅ„\n/status - Status\n/on - WÅ‚Ä…cz powiadomienia\n/off - WyÅ‚Ä…cz powiadomienia\n/pojedyncze - Tryb pojedynczy\n/zbiorcze - Tryb zbiorczy\n/cisza - Ustaw ciszÄ™ nocnÄ…\n/cisza_off - WyÅ‚Ä…cz ciszÄ™ nocnÄ…\n/najnowsze [ID] - PokaÅ¼ najnowsze\n/najtansze [ID] - PokaÅ¼ najtaÅ„sze\n/plany - PokaÅ¼ plany\n/panel - Link do panelu\n/lang - ZmieÅ„ jÄ™zyk",
      
      unauthorized: "âŒ Brak uprawnieÅ„ (tylko admin).",
      provide_id: "âŒ Podaj Telegram ID: /admin_reset &lt;telegram_id&gt;",
      user_not_found: "âŒ Nie znaleziono uÅ¼ytkownika dla Telegram ID {id}",
      
      link_not_found: "Nie znalazÅ‚em linku o ID <b>{id}</b> na Twoim koncie. UÅ¼yj /lista.",
      no_links: "Nie masz jeszcze Å¼adnych linkÃ³w.",
      
      usage_usun: "Podaj ID linku, np.:\n<code>/usun 18</code>",
      usage_najnowsze: "UÅ¼ycie: <code>/najnowsze [ID]</code>\nBez ID: wszystkie linki\nZ ID: konkretny link\n\nPrzykÅ‚ady:\n<code>/najnowsze</code>\n<code>/najnowsze 18</code>",
      usage_najtansze: "UÅ¼ycie: <code>/najtansze [ID]</code>\nBez ID: wszystkie linki\nZ ID: konkretny link\n\nPrzykÅ‚ady:\n<code>/najtansze</code>\n<code>/najtansze 18</code>",
      usage_dodaj: "UÅ¼ycie:\n<code>/dodaj &lt;url&gt; [nazwa]</code>\n\nPrzykÅ‚ad:\n<code>/dodaj https://www.olx.pl/oferty/?q=iphone14 iPhone 14 OLX</code>",
      
      error_panel: "âŒ Nie udaÅ‚o siÄ™ wygenerowaÄ‡ linku do panelu.\n\nrequestId: {requestId}",
      error_payment_config: "âŒ BÅ‚Ä…d konfiguracji pÅ‚atnoÅ›ci.\n\nrequestId: {requestId}",
      error_addon_config: "âŒ BÅ‚Ä…d konfiguracji dodatku.\n\nrequestId: {requestId}",
      error_no_purchase: "âŒ Brak dostÄ™pnych opcji zakupu.",
      error_payment_create: "âŒ BÅ‚Ä…d tworzenia pÅ‚atnoÅ›ci.\n\nrequestId: {requestId}",
      error_lista: "âŒ BÅ‚Ä…d przy pobieraniu listy linkÃ³w.",
      error_usun: "âŒ BÅ‚Ä…d przy wyÅ‚Ä…czaniu linku.",
      error_dodaj: "âŒ BÅ‚Ä…d przy dodawaniu linku.",
      error_status: "âŒ BÅ‚Ä…d przy pobieraniu statusu.",
      error_stripe_not_configured: "âŒ Stripe nie skonfigurowany.\n\nrequestId: {requestId}",
      error_addon_not_configured: "âŒ Brak konfiguracji dla dodatku.\n\nrequestId: {requestId}",
      user_not_in_db: "Nie widzÄ™ CiÄ™ w bazie. UÅ¼yj /start lub /dodaj.",
      user_not_registered: "Nie widzÄ™ CiÄ™ jeszcze w bazie.\nNajpierw uÅ¼yj /dodaj (zarejestruje konto), a potem /status.",
      
      // Command responses for notification commands
      notif_enabled_response: "âœ… Powiadomienia WÅÄ„CZONE na tym czacie.",
      notif_disabled_response: "â›” Powiadomienia WYÅÄ„CZONE na tym czacie.",
      notif_single_response: "ğŸ“¨ Ustawiono tryb: <b>pojedynczo</b> (domyÅ›lny dla tego czatu).",
      notif_batch_response: "ğŸ“¦ Ustawiono tryb: <b>zbiorczo</b> (domyÅ›lny dla tego czatu).",
    },
    
    dodaj: {
      invalid_url: "Pierwszy parametr musi byÄ‡ poprawnym URL, np.:\n<code>/dodaj https://www.olx.pl/oferty/?q=iphone14 iPhone 14 OLX</code>",
      trial_expired: "â° TwÃ³j plan Trial wygasÅ‚.\nMonitoring w Trial jest juÅ¼ niedostÄ™pny.\n\nAby dalej korzystaÄ‡ z bota, wybierz plan pÅ‚atny (Starter / Growth / Platinum).",
      plan_expired: "â° TwÃ³j plan wygasÅ‚.\nAby dodaÄ‡ nowe linki i wznowiÄ‡ monitoring, przedÅ‚uÅ¼ plan w panelu klienta.",
      no_active_plan_trial_used: "Nie masz aktywnego planu z monitoringiem linkÃ³w.\nTrial zostaÅ‚ juÅ¼ wykorzystany. Wykup plan Starter / Growth / Platinum.",
      no_active_plan_trial_available: "Nie masz aktywnego planu z monitoringiem linkÃ³w.\nMoÅ¼esz uruchomiÄ‡ jednorazowo Trial (3 dni / 5 linkÃ³w) albo wybraÄ‡ plan Starter / Growth / Platinum.",
      success: "âœ… DodaÅ‚em nowy link do monitorowania:\n\nID <b>{id}</b> â€” {name}\n<code>{url}</code>\n\nAktywne linki: {active}/{limit}\n\nLinki sprawdzisz komendÄ…: <code>/lista</code>",
      no_name: "(bez nazwy)",
    },
    
    najnowsze: {
      header: "ğŸ§¾ Najnowsze oferty\n<b>{name}</b> <i>(ID {id})</i>\n",
      no_history: "\nBrak zapisanej historii dla tego linku (jeszcze).",
      no_title: "(bez tytuÅ‚u)",
      truncated: "â€¦ (uciÄ™to â€“ limit dÅ‚ugoÅ›ci wiadomoÅ›ci)\n",
      link_not_found_detail: "Nie widzÄ™ linku <b>{id}</b> na Twoim koncie. SprawdÅº <code>/lista</code>.",
    },

    // /najtansze (najtaÅ„sze wysÅ‚ane oferty)
    najtansze: {
      header_per_link: "ğŸ’° NajtaÅ„sze wysÅ‚ane (link {id})\n<b>{name}</b>\nOd: {since}",
      header_global: "ğŸ’° NajtaÅ„sze wysÅ‚ane (od {since})",
      no_history_per_link: "Brak wysÅ‚anych ofert z cenÄ… dla linku <b>{id}</b> od {since}.",
      no_history_global: "Brak wysÅ‚anych ofert z cenÄ… od {since}.",
      footer: "PeÅ‚na historia:",
    },
    
    // Enhanced najnowsze (najnowsze wysÅ‚ane oferty)
    najnowsze_enhanced: {
      header_per_link: "ğŸ§¾ Najnowsze wysÅ‚ane (link {id})\n<b>{name}</b>\nOd: {since}",
      header_global: "ğŸ§¾ Najnowsze wysÅ‚ane (od {since})",
      no_history_per_link: "Brak wysÅ‚anych ofert dla linku <b>{id}</b> od {since}.",
      no_history_global: "Brak wysÅ‚anych ofert od {since}.",
      footer: "PeÅ‚na historia:",
      no_title: "(bez tytuÅ‚u)",
    },
        notif: {
      enabled: "âœ… Powiadomienia WÅÄ„CZONE na tym czacie.",
      disabled: "â›” Powiadomienia WYÅÄ„CZONE na tym czacie.",
      mode_single: "ğŸ“¨ Ustawiono tryb: <b>pojedynczo</b> (domyÅ›lny na tym czacie).",
      mode_batch: "ğŸ“¦ Ustawiono tryb: <b>zbiorczo</b> (domyÅ›lny na tym czacie).",
    },
    
    quiet: {
      status_on: "ğŸŒ™ Cisza nocna: <b>WÅÄ„CZONA</b>, godziny {from}:00â€“{to}:00",
      status_off: "ğŸŒ™ Cisza nocna: <b>wyÅ‚Ä…czona</b>.\nUstaw: <code>/cisza 22-7</code>",
      usage: "Podaj zakres jako HH-HH, np. <code>/cisza 22-7</code>",
      invalid_hours: "Godziny muszÄ… byÄ‡ w zakresie 0â€“23, np. <code>/cisza 22-7</code>",
      set: "ğŸŒ™ Ustawiono ciszÄ™ nocnÄ…: <b>{from}:00â€“{to}:00</b>",
      disabled: "ğŸŒ™ Cisza nocna <b>wyÅ‚Ä…czona</b>.",
      disabled_alt: "ğŸŒ™ Cisza nocna: <b>WYÅÄ„CZONA</b>",
    },
    
    lista: {
      header: "ğŸ“‹ Aktywne monitorowane linki:\n\n",
      footer: "WyÅ‚Ä…cz: <code>/usun ID</code>\nnp. <code>/usun 18</code>",
      no_name: "(bez nazwy)",
    },
    
    usun: {
      success: "âœ… WyÅ‚Ä…czyÅ‚em monitorowanie linku:\n\n",
      footer: "MoÅ¼esz go wÅ‚Ä…czyÄ‡ ponownie w panelu albo dodaÄ‡ ponownie jako nowe monitorowanie.",
    },
    
    najnowsze: {
      header: "ğŸ†• Najnowsze pozycje dla linku ID <b>{id}</b>",
      no_history: "Brak zapisanej historii dla tego linku (jeszcze).",
    },
    
    status: {
      title: "â„¹ï¸ Status bota",
      plan: "Plan: {name} (do {exp})",
      plan_with_addons: "Plan: {name} (do {exp})\nDodatki (addon +10): {addons}",
      links_enabled: "Aktywne wyszukiwania (wÅ‚Ä…czone): {enabled}/{limit}",
      links_total: "ÅÄ…cznie wyszukiwaÅ„ (w bazie): {total}/{limit}",
      daily_limit: "Limit dziennych powiadomieÅ„: {limit}",
      notif_enabled: "âœ… Powiadomienia WÅÄ„CZONE",
      notif_disabled: "â›” Powiadomienia WYÅÄ„CZONE",
      notif_mode: "Tryb domyÅ›lny na tym czacie: {mode}",
      notif_daily: "Dzisiejsze powiadomienia: {daily}/{limit}",
      quiet_on: "Cisza nocna: wÅ‚Ä…czona ({from}:00â€“{to}:00)",
      quiet_off: "Cisza nocna: wyÅ‚Ä…czona",
      per_link_hint: "Komendy: /on /off /pojedyncze /zbiorcze\nPer link: /pojedyncze_ID /zbiorcze_ID /off_ID /on_ID",
      no_links: "Brak aktywnych wyszukiwaÅ„.",
      links_header: "Lista wyszukiwaÅ„:",
    },
    
    lang: {
      current: "Obecny jÄ™zyk: <b>{name}</b>",
      available: "DostÄ™pne jÄ™zyki:",
      unknown: "âŒ Nieznany kod jÄ™zyka: <code>{code}</code>",
      confirm: "âœ… Ustawiono jÄ™zyk: <b>{name}</b>",
    }
  },
  
  // German - empty, falls back to EN
  de: {},
  
  // French - empty, falls back to EN
  fr: {},
  
  // Croatian - empty, falls back to EN
  hr: {},
};

// Interpolate variables in string
function interpolate(str, vars = {}) {
  return String(str).replace(/\{(\w+)\}/g, (_, key) => {
    return vars[key] !== undefined && vars[key] !== null ? String(vars[key]) : `{${key}}`;
  });
}

// Get translation by path (e.g. "cmd.help")
function getByPath(obj, path) {
  const parts = String(path).split(".");
  let cur = obj;
  for (const p of parts) {
    if (!cur || typeof cur !== "object" || !(p in cur)) return null;
    cur = cur[p];
  }
  return cur;
}

export function t(lang, key, vars = {}) {
  const dict = TRANSLATIONS[lang] || TRANSLATIONS.en || {};
  const dictEn = TRANSLATIONS.en || {};

  // 1) peÅ‚na Å›cieÅ¼ka (np. "cmd.help_greeting")
  let s = getByPath(dict, key);

  // 2) jeÅ›li ktoÅ› podaÅ‚ bez "cmd." (np. "help_greeting") - sprÃ³buj cmd.*
  if (s == null && !key.includes(".")) {
    s = dict?.cmd?.[key];
  }

  // 3) fallback do EN (te same 2 prÃ³by)
  if (s == null) {
    s = getByPath(dictEn, key);
  }
  if (s == null && !key.includes(".")) {
    s = dictEn?.cmd?.[key];
  }

  // 4) ostatecznie: key (ale to ma juÅ¼ praktycznie nie wystÄ…piÄ‡)
  if (s == null) {
    console.error(`[i18n_missing] lang=${lang} key=${key} NOT FOUND in any dict`);
    return key;
  }

  return interpolate(s, vars);
}
// user.language_code is still stored in DB for future translations, but not used for UI yet
export function getUserLang(user) {
  if (!user) return "en";
  
  const lc = String(user.language_code || user.lang || user.language || "").toLowerCase();
  
  // Map language codes
  if (lc.startsWith("pl")) return "pl";
  if (lc.startsWith("de")) return "de";
  if (lc.startsWith("fr")) return "fr";
  if (lc.startsWith("it")) return "it";
  if (lc.startsWith("es")) return "es";
  if (lc.startsWith("pt")) return "pt";
  if (lc.startsWith("cs")) return "cs";
  if (lc.startsWith("sk")) return "sk";
  if (lc.startsWith("ro")) return "ro";
  if (lc.startsWith("nl")) return "nl";
  
  // Default to EN
  return "en";
}
export default { t, getUserLang, TRANSLATIONS };
